<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ART GUIDE RUN | 아트가이드런</title>
    <!-- CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/notyf@3.10.0/notyf.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../assets/css/style.css" />
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/notyf@3.10.0/notyf.min.js"></script>
    <script src="../js/common.js" defer></script>
  </head>
  <body class="hd_type02">
    <div id="root_layout">
      <div class="root_container">
        <div class="sticky_menu">
          <div id="header_area"></div>
        </div>

        <div id="contents">
          <div class="inner">
            <div class="find_info_area">
              <img
                src="../assets/images/icon_complete.svg"
                alt="본인인증 완료 아이콘"
                aria-hidden="true"
              />
              <p>
                본인인증이 완료되었습니다. <br />
                새로운 비밀번호를 입력해 주세요.
              </p>
            </div>
            <div class="pb_80">
              <form id="resetPwForm" onSubmit="return formValid(this);">
                <div class="input_list_area gap_24">
                  <div class="label_input_area">
                    <label for="password" class="label">새 비밀번호 입력</label>
                    <div class="input_pw_area">
                      <input
                        type="password"
                        name="password"
                        id="password"
                        class="input"
                        placeholder="8-16자리 영문,숫자,특수문자 조합"
                      />
                      <button type="button">
                        <span>비밀번호 보기</span>
                      </button>
                    </div>
                    <span class="error_msg d_none">오류 메시지</span>
                  </div>
                  <div class="label_input_area">
                    <label for="password_confirm" class="label">
                      새 비밀번호 확인
                    </label>
                    <div class="input_pw_area">
                      <input
                        type="password"
                        name="password_confirm"
                        id="password_confirm"
                        class="input"
                        placeholder="비밀번호를 한번 더 입력해주세요"
                      />
                      <button type="button">
                        <span>비밀번호 보기</span>
                      </button>
                    </div>
                    <span class="error_msg d_none">오류 메시지</span>
                  </div>
                  <button
                    type="submit"
                    class="btn btn_style01 btn_size_52"
                    disabled
                  >
                    확인
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- modal -->
        <div class="modal_wrap msg" id="md_changed">
          <div class="modal_area">
            <span>비밀번호가 <br />변경되었습니다.</span>
            <div class="btn_area">
              <button
                type="button"
                class="btn btn_style01 btn_size_52"
                onClick="location.href='./login.html'"
              >
                확인
              </button>
            </div>
          </div>
        </div>
        <!-- // modal -->
      </div>
    </div>

    <script>
      // ===== 공통 영역 설정 스크립트 =====
      $("#header_area").load("../include/header.html");

      $(window).on("load", function () {
        $("#header h1").text("비밀번호 재설정");
      });

      // ===== 페이지 =====
      $("input").on("input", function () {
        const f = document.querySelector("#resetPwForm");
        if (f.password.value !== "" && f.password_confirm.value !== "")
          f.querySelector("button[type=submit]").disabled = false;
        else f.querySelector("button[type=submit]").disabled = true;

        $(this).removeClass("error");
        $(this)
          .parents(".label_input_area")
          .find(".error_msg")
          .addClass("d_none");
      });

      const formValid = (f) => {
        if (f.password.value == "") {
          $(f.password)
            .addClass("error")
            .parents(".label_input_area")
            .find(".error_msg")
            .text("비밀번호를 입력해 주세요.")
            .removeClass("d_none");
          f.password.focus();
          return false;
        }

        if (!regPassword.test(f.password.value)) {
          $(f.password)
            .addClass("error")
            .parents(".label_input_area")
            .find(".error_msg")
            .text("영문, 숫자, 특수문자를 조합해서 입력해주세요. (8-16자)")
            .removeClass("d_none");
          f.password.focus();
          return false;
        }

        if (f.password.value !== f.password_confirm.value) {
          $(f.password_confirm)
            .addClass("error")
            .parents(".label_input_area")
            .find(".error_msg")
            .text("확인 비밀번호가 일치하지 않습니다.")
            .removeClass("d_none");
          f.password_confirm.focus();
          return false;
        }

        // return true;
        onModalShow("md_changed");
        return false;
      };
    </script>
  </body>
</html>
